# NeyroGamer
> Генетический алгоритм, обучающий нейронные сети играть в Nigel Mansell's World Championship Racing с платформы Sega Genesis. Без использования ML библиотек

## Стек
- Python
- numpy
- pyvjoy (Виртуальный геймпад)
- pyautogui (Виртуальная клавиатура)
- Pillow (Получение изображения из игры)
- OpenCV (Обработка скриншотов)
- flask (Вывод отладочной информации)
- threading

## О проекте
- Обучаем нейронные сети с помощью генетического алгоритма. Каждая особь - набор весов для нейронной сети
- В запущенном окне эмулятора делаем скриншот, обрабатываем, подаём на вход нейронной сети, и в соответствии с её выходом нажимаем кнопки виртуального геймпада
- Запускаем каждую особь в начало гонки, тестируем, выдаём очки за скорость и близость к центру дороги. Лучшие особи скрещиваются и мутируют, для получения следующего поколения

## Как это работает
[![IMAGE ALT TEXT HERE](https://img.youtube.com/vi/DpyXo5CuKYU/0.jpg)](https://www.youtube.com/watch?v=DpyXo5CuKYU)

> Нажмите для перехода к видео на YouTube

## Запуск
Установите эмулятор Fusion 3.64 и виртуальный контроллер vJoy.

Установите библиотеки

    pip install numpy pyautogui pillow opencv-python flask

Используйте `AssignKeys.py` чтобы назначить управление в эмуляторе. Когда спринт напишет `PRESS ENTER` нажмите любую клавишу, она будет отвечать за паузу в игре.

Настройте кол-во особей в поколении, время тестирования и кол-во входов (размер входного изображения) каждой особи в `run.py`

Запустите `run.py` для продолжения обучения (чтобы начать обучения с нуля, удалите файлы в `./NeyroData` и закомментируйте секцию чтения при первом запуске)

Статистику можно посмотреть на `http://localhost:5000`
Текущее видео, с наложенными маркерами можно посмотеть на `http://localhost:5000/video`. С помощью него настройте параметры `ScreenReaderClass`, чтобы захватить картинку из эмулятора